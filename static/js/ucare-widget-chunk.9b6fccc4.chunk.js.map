{"version":3,"sources":["../node_modules/@uploadcare/react-widget/dist/esm/uploader-5199635b.js"],"names":["__webpack_require__","r","__webpack_exports__","_index_ded791f3_js__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1__","react__WEBPACK_IMPORTED_MODULE_1___default","n","uploadcare_widget__WEBPACK_IMPORTED_MODULE_2__","uploadcare_widget__WEBPACK_IMPORTED_MODULE_2___default","_use_deep_effect_393663e2_js__WEBPACK_IMPORTED_MODULE_3__","react_fast_compare__WEBPACK_IMPORTED_MODULE_4__","react_fast_compare__WEBPACK_IMPORTED_MODULE_4___default","useEventCallback","callback","ref","value","Object","current","useCommitedRef","apply","arguments","useWidget","_ref3","uploadcare","id","name","onFileSelect","onChange","onDialogOpen","onDialogClose","onTabChange","apiRef","customTabs","validators","tabsCss","locale","localeTranslations","localePluralize","previewUrlCallback","options","input","widget","fileSelectedCallback","changeCallback","dialogOpenCallback","dialogCloseCallback","tabChangeCallback","attributes","factory","deps","isValid","valueRef","result","cache","useDeepMemo","props","entries","reduce","attr","_ref","_ref2","key","concat","replace","toLowerCase","window","UPLOADCARE_LOCALE","UPLOADCARE_LOCALE_PLURALIZE","UPLOADCARE_LOCALE_TRANSLATIONS","UPLOADCARE_PREVIEW_URL_CALLBACK","plugin","internal","rebuild","Widget","widgetElement","nextSibling","parentNode","removeChild","instance","forEach","validator","push","length","useValidators","onUploadComplete","add","remove","dialog","saveDialog","done","fail","progress","reject","files","saveFiles","file","cancel","indexOf","addUrl","addStyle","openDialog","reloadInfo","getInput","inputElement","a","createElement","type","Input"],"mappings":"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","file":"static/js/ucare-widget-chunk.9b6fccc4.chunk.js","sourcesContent":["import { _ as _extends, a as _objectWithoutProperties, b as _slicedToArray, c as _objectSpread2, d as _defineProperty } from './index-ded791f3.js';\nimport React, { useRef, useEffect, useCallback, useImperativeHandle } from 'react';\nimport uploadcare from 'uploadcare-widget';\nimport { u as useCustomTabs, a as useDeepEffect } from './use-deep-effect-393663e2.js';\nimport isEqual from 'react-fast-compare';\nimport '@uploadcare/client-suspense';\n\nvar useCommitedRef = function useCommitedRef(value) {\n  var ref = useRef(value);\n  useEffect(function () {\n    ref.current = value;\n  }, [value]);\n  return ref;\n};\n\nvar useEventCallback = function useEventCallback(callback) {\n  var ref = useCommitedRef(callback);\n  return useCallback(function () {\n    return ref.current && ref.current.apply(ref, arguments);\n  }, [ref]);\n};\n\nvar useValidators = function useValidators(widget, validators) {\n  useEffect(function () {\n    if (validators != null) {\n      var instance = widget.current;\n      validators.forEach(function (validator) {\n        instance.validators.push(validator);\n      });\n      return function () {\n        instance.validators.length = 0;\n      };\n    }\n  }, [widget, validators]);\n};\n\nfunction useDeepMemo(factory, deps) {\n  var isValid = true;\n  var valueRef = useRef(); // initial hook call\n\n  if (!valueRef.current) {\n    valueRef.current = {\n      deps: deps,\n      result: factory()\n    }; // subsequent calls\n  } else {\n    isValid = !!(deps && valueRef.current.deps && isEqual(deps, valueRef.current.deps));\n  }\n\n  var cache = isValid ? valueRef.current : {\n    deps: deps,\n    result: factory()\n  }; // must update immediately so any sync renders here don't cause an infinite loop\n\n  valueRef.current = cache;\n  return cache.result;\n}\n\nfunction camelCaseToDash(str) {\n  return str.replace(/([a-zA-Z])(?=[A-Z])/g, '$1-').toLowerCase();\n}\n\nvar propsToAttr = function propsToAttr(props) {\n  return Object.entries(props).reduce(function (attr, _ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        key = _ref2[0],\n        value = _ref2[1];\n\n    return _objectSpread2(_objectSpread2({}, attr), {}, _defineProperty({}, \"data-\".concat(camelCaseToDash(key)), value));\n  }, {});\n};\n\nvar useWidget = function useWidget(_ref3, uploadcare) {\n  var id = _ref3.id,\n      name = _ref3.name,\n      value = _ref3.value,\n      onFileSelect = _ref3.onFileSelect,\n      onChange = _ref3.onChange,\n      onDialogOpen = _ref3.onDialogOpen,\n      onDialogClose = _ref3.onDialogClose,\n      onTabChange = _ref3.onTabChange,\n      apiRef = _ref3.apiRef,\n      customTabs = _ref3.customTabs,\n      validators = _ref3.validators,\n      tabsCss = _ref3.tabsCss,\n      locale = _ref3.locale,\n      localeTranslations = _ref3.localeTranslations,\n      localePluralize = _ref3.localePluralize,\n      previewUrlCallback = _ref3.previewUrlCallback,\n      options = _objectWithoutProperties(_ref3, [\"id\", \"name\", \"value\", \"onFileSelect\", \"onChange\", \"onDialogOpen\", \"onDialogClose\", \"onTabChange\", \"apiRef\", \"customTabs\", \"validators\", \"tabsCss\", \"locale\", \"localeTranslations\", \"localePluralize\", \"previewUrlCallback\"]);\n\n  var input = useRef(null);\n  var widget = useRef(null);\n  var fileSelectedCallback = useEventCallback(onFileSelect);\n  var changeCallback = useEventCallback(onChange);\n  var dialogOpenCallback = useEventCallback(onDialogOpen);\n  var dialogCloseCallback = useEventCallback(onDialogClose);\n  var tabChangeCallback = useEventCallback(onTabChange);\n  useCustomTabs(customTabs, uploadcare);\n  var attributes = useDeepMemo(function () {\n    return propsToAttr(options);\n  }, [options]);\n  useDeepEffect(function () {\n    if (locale) window.UPLOADCARE_LOCALE = locale;\n    if (localePluralize) window.UPLOADCARE_LOCALE_PLURALIZE = localePluralize;\n\n    if (localeTranslations) {\n      window.UPLOADCARE_LOCALE_TRANSLATIONS = localeTranslations;\n    }\n\n    if (previewUrlCallback) {\n      window.UPLOADCARE_PREVIEW_URL_CALLBACK = previewUrlCallback;\n    }\n\n    uploadcare.plugin(function (internal) {\n      internal.locale.rebuild({\n        locale: locale || null,\n        localeTranslations: localeTranslations || null,\n        localePluralize: localePluralize || null\n      });\n    });\n    return function () {\n      if (locale) delete window.UPLOADCARE_LOCALE;\n      if (localePluralize) delete window.UPLOADCARE_LOCALE_PLURALIZE;\n      if (localeTranslations) delete window.UPLOADCARE_LOCALE_TRANSLATIONS;\n      if (previewUrlCallback) delete window.UPLOADCARE_PREVIEW_URL_CALLBACK;\n    };\n  }, [locale, localeTranslations, localePluralize, previewUrlCallback]);\n  useEffect(function () {\n    widget.current = uploadcare.Widget(input.current);\n    var widgetElement = input.current.nextSibling;\n    return function () {\n      return widgetElement && widgetElement.parentNode.removeChild(widgetElement);\n    };\n  }, [uploadcare, attributes]);\n  useValidators(widget, validators);\n  useEffect(function () {\n    widget.current.onUploadComplete.add(changeCallback);\n    widget.current.onChange.add(fileSelectedCallback);\n    return function () {\n      widget.current.onUploadComplete.remove(changeCallback);\n      widget.current.onChange.remove(fileSelectedCallback);\n    };\n  }, [changeCallback, fileSelectedCallback, uploadcare, attributes]);\n  useEffect(function () {\n    var dialog;\n\n    var saveDialog = function saveDialog(ref) {\n      dialog = ref;\n      dialog.done(dialogCloseCallback).fail(dialogCloseCallback).progress(tabChangeCallback);\n      dialogOpenCallback(ref);\n    };\n\n    widget.current.onDialogOpen.add(saveDialog);\n    return function () {\n      widget.current.onDialogOpen.remove(saveDialog);\n      dialog && dialog.reject();\n    };\n  }, [attributes, dialogCloseCallback, dialogOpenCallback, tabChangeCallback]);\n  useEffect(function () {\n    var files = [];\n\n    var saveFiles = function saveFiles(file) {\n      if (file) {\n        files = file.files ? file.files() : [file];\n      } else {\n        files = [];\n      }\n    };\n\n    widget.current.onChange.add(saveFiles);\n    return function () {\n      files.forEach(function (file) {\n        return file.cancel();\n      });\n      widget.current.onChange.remove(saveFiles);\n    };\n  }, [attributes]);\n  useEffect(function () {\n    widget.current.value(value);\n  }, [value]);\n  useEffect(function () {\n    if (uploadcare && tabsCss && typeof tabsCss === 'string') {\n      if (tabsCss.indexOf('https://') === 0) {\n        uploadcare.tabsCss.addUrl(tabsCss);\n      } else {\n        uploadcare.tabsCss.addStyle(tabsCss);\n      }\n    }\n  }, [uploadcare, tabsCss]);\n  useImperativeHandle(apiRef, function () {\n    return {\n      openDialog: function openDialog() {\n        return widget.current.openDialog();\n      },\n      reloadInfo: function reloadInfo() {\n        return widget.current.reloadInfo();\n      },\n      getInput: function getInput() {\n        return widget.current.inputElement;\n      }\n    };\n  }, []);\n  return useCallback(function () {\n    return /*#__PURE__*/React.createElement(\"input\", _extends({\n      type: \"hidden\",\n      ref: input,\n      id: id,\n      name: name\n    }, attributes));\n  }, [attributes, id, name]);\n};\n\nvar Uploader = function Uploader(props) {\n  var Input = useWidget(props, uploadcare);\n  return /*#__PURE__*/React.createElement(Input, null);\n};\n\nexport default Uploader;"],"sourceRoot":""}